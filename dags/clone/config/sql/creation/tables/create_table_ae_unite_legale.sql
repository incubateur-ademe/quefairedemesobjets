/*
Schema generated by scripts/db_schema_create_from_csv.py
 - Strict on ID-like fields (e.g. siren, siret etc...)
 - Loose on other fields to avoid pipeline failures for variable data
 - VARCHAR for the same reason we don't control the data
 - {{table_name}} so that no one can run this by mistake AND
    to facilitate table name replacement in Python
 - Indexes to improve performance
   游댮 HOWEVER don't abuse indexes as they get large (e.g. on
   SIRET it's 1.2GB)
*/

CREATE TABLE {{table_name}} (
  "siren" VARCHAR(9), -- 游리 on reste scrict
  "statutDiffusionUniteLegale" VARCHAR(1), -- 游리 on reste scrict
  "unitePurgeeUniteLegale" VARCHAR(4), -- 游리 on reste scrict
  "dateCreationUniteLegale" VARCHAR(10), -- 游리 on reste scrict
  "sigleUniteLegale" VARCHAR(20), -- 游리 on reste scrict
  "sexeUniteLegale" VARCHAR(4), -- 游리 on reste scrict
  "prenom1UniteLegale" VARCHAR(50),  -- 20 -> 50
  "prenom2UniteLegale" VARCHAR(50),  -- 20 -> 50
  "prenom3UniteLegale" VARCHAR(50),  -- 20 -> 50
  "prenom4UniteLegale" VARCHAR(50),  -- 20 -> 50
  "prenomUsuelUniteLegale" VARCHAR(50), -- 20 -> 50
  "pseudonymeUniteLegale" VARCHAR(150), -- 93 -> 150
  "identifiantAssociationUniteLegale" VARCHAR(10), -- 游리 on reste scrict
  "trancheEffectifsUniteLegale" VARCHAR(2), -- 2 -> 3
  "anneeEffectifsUniteLegale" VARCHAR(4), -- 游리 on reste scrict
  "dateDernierTraitementUniteLegale" VARCHAR(50), -- 19 -> 50
  "nombrePeriodesUniteLegale" VARCHAR(2), -- 2 -> 3
  "categorieEntreprise" VARCHAR(3), -- 游리 on reste scrict
  "anneeCategorieEntreprise" VARCHAR(4), -- 游리 on reste scrict
  "dateDebut" VARCHAR(10), -- 游리 on reste scrict
  "etatAdministratifUniteLegale" VARCHAR(1), -- 游리 on reste scrict
  "nomUniteLegale" VARCHAR(100), -- 66 -> 100
  "nomUsageUniteLegale" VARCHAR(100), -- 69 -> 100
  "denominationUniteLegale" VARCHAR(120), -- 120 -> 150
  "denominationUsuelle1UniteLegale" VARCHAR(100), -- 70 -> 100
  "denominationUsuelle2UniteLegale" VARCHAR(100), -- 70 -> 100
  "denominationUsuelle3UniteLegale" VARCHAR(100), -- 1700 -> 100
  "categorieJuridiqueUniteLegale" VARCHAR(4), -- 4 -> 10
  "activitePrincipaleUniteLegale" VARCHAR(6), -- = Code NAF = 游리 on reste scrict
  "nomenclatureActivitePrincipaleUniteLegale" VARCHAR(7), -- 7 -> 10
  "nicSiegeUniteLegale" VARCHAR(5), -- 游리 on reste scrict
  "economieSocialeSolidaireUniteLegale" VARCHAR(1), -- 游리 on reste scrict
  "societeMissionUniteLegale" VARCHAR(50), -- None -> 50
  "caractereEmployeurUniteLegale" VARCHAR(50)  -- None -> 50
);

/* Constraints
Just to verify that our import is working correctly
*/
ALTER TABLE {{table_name}}
ADD CONSTRAINT pk_{{table_name}} PRIMARY KEY (siren);

/* Indexes
游댮 DO NOT USE indexes on those import tables: they can easily
reach > 1 GB per index (e.g. SIRET on etablissement = 1.2GB)
and these tables are not intended for direct use. Instead we
will implement indexes on the desired DBT models
*/