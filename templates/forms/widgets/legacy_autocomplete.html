{% load custom_filters %}
<div
    class="fr-my-1w qfdmo-flex-grow"
>
    <div
        class="autocomplete qfdmo-relative"
        {# TODO : Voir pour mieux gérer ce cas si le controleur est déjà défini sur le parent quelque part #}
        data-controller="{{ widget.data_controller }}"
    >
        <input
            data-action="
            input->{{ widget.data_controller }}#complete
        focus->{{ widget.data_controller }}#complete
        keydown.down->{{ widget.data_controller }}#keydownDown
        keydown.up->{{ widget.data_controller }}#keydownUp
        keydown.enter->{{ widget.data_controller }}#keydownEnter
        keydown.esc->{{ widget.data_controller }}#closeAllLists
        blur->{{ widget.data_controller }}#blurInput"
        data-{{ widget.data_controller }}-target="input"
        data-on-focus=true
        type="{{ widget.type }}"
        name="{{ widget.name }}"
        {% if widget.value != None %} value="{{ widget.value|stringformat:'s' }}"{% endif %}
        {% include "django/forms/widgets/attrs.html" %}
        >
        <span data-{{ widget.data_controller }}-target="spinner" class="fr-icon-refresh-line qfdmo-absolute qfdmo-right-0 qfdmo-top-0 qfdmo-m-1w qfdmo-animate-spin qfdmo-hidden"></span>
        <script type="application/json" data-{{ widget.data_controller }}-target="allAvailableOptions">
            {{ widget.optgroups }}
        </script>
    </div>
    <p data-address-autocomplete-target="displayError" class="fr-error-text fr-mt-1w" style="display:none;">
        Texte d’erreur obligatoire
    </p>
</div>
