{% load dsfr_tags %}
<header
    {# The z-index below can impact the shadow over #}
    class="{% block header_classes %}qf-z-20{% endblock %} qf-bg-white {% if not no_shadow %}qf-shadow-lg{% endif %}"
>
    <div
        class="
        qf-flex qf-flex-col md:qf-flex-row sm:qf-items-center"
    >

        {% if not carte_config or not carte_config.supprimer_branding %}
        <div
            class="qf-items-center qf-hidden md:qf-flex qf-flex-row"
            id="logo"
            data-remove-if-internal
        >
            {% include 'ui/layout/_partials/header_logos.html' %}
        </div>
        {% endif %}


        {# Recherche adresse #}
        <div class="fr-my-1w qf-flex-grow qf-flex qf-flex-col
            {% if not carte_config or not carte_config.supprimer_branding %}qf-px-2w md:qf-px-3w {% else %}qf-p-2w{% endif %}"
        >
            {% include "ui/components/carte/_addresses_partials/adresse_input_form.html" %}

            {% comment %}
            {% if not carte_config or not carte_config.cacher_legende %}
            <div class="lg:qf-hidden fr-mt-1w qf-flex qf-justify-between">
                {% if not carte_config or not carte_config.supprimer_branding %}
                <button
                    class="fr-btn fr-btn--sm fr-btn--tertiary"
                    type="button"
                    title="À propos"
                    data-action="click -> search-solution-form#toggleAPropos"
                    data-remove-if-internal
                >
                    Infos
                </button>
                {% endif %}
                <div class="qf-flex qf-flex-row-reverse">
                    {% if form.legend_grouped_action|length > 1 %}
                    <button
                        class="fr-btn fr-btn--sm fr-btn--secondary fr-ml-1w fr-btn--icon-left fr-icon-eye-line"
                        type="button"
                        data-testid="legend-mobile-button"
                        data-action="click -> search-solution-form#showLegend"
                    >
                        Légende
                    </button>
                    {% endif %}
                    <button
                        class="fr-btn max-md:fr-btn--sm fr-btn--secondary fr-ml-1w fr-btn--icon-left fr-icon-equalizer-line"
                        type="button"
                        data-action="search-solution-form#toggleAdvancedFilters"
                        data-testid="advanced-filters"
                    >
                        Filtres
                    </button>
                </div>
            </div>
            {% endif %}
            {% endcomment %}
        </div>

        {# Navigation entre carte / liste #}
        <div class="md:qf-pr-2w max-md:qf-px-2w max-md:qf-flex qf-justify-between qf-items-end max-md:qf-pb-1w" id="view-mode-nav">
            {{ forms.view_mode }}
            <div class="md:qf-hidden">
            {% dsfr_button label="Filtres" extra_classes="fr-btn--sm fr-btn--secondary fr-ml-1w fr-btn--icon-left fr-icon-equalizer-line" data_action="search-solution-form#toggleAdvancedFilters:prevent" data_testid="advanced-filters" %}
            </div>
        </div>
    </div>
</header>
