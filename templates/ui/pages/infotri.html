{% extends "ui/layout/base.html" %}
{% load dsfr_tags static %}

{% block page_title %}Concevez facilement votre Info-tri [Beta] - Longue vie aux objets{% endblock %}

{% block page_description %}Générateur d'Info-tri pour produits textiles, vêtements et chaussures{% endblock %}

{% block body_classes %}qf-overflow-auto qf-bg-gradient-infotri{% endblock %}

{% block content %}
<div class="qf-grid qf-h-screen qf-w-screen qf-grid-cols-1 md:qf-grid-cols-3"
     data-controller="infotri"
     data-infotri-base-url-value="{{ base_url }}">
    <main
        class="qf-flex qf-flex-col qf-items-start qf-gap-2w qf-p-2w qf-overflow-auto md:qf-col-span-2"
    >
        <h1 class="qf-mb-1w qf-text-2xl qf-leading-none qf-font-extrabold qf-tracking-tight qf-text-gray-900 md:qf-text-3xl lg:qf-text-4xl">
            Concevez facilement votre Info-tri [Beta]
        </h1>

        <p class="qf-max-w-prose">
            Ce générateur ne permet, pour le moment, que la création d'Info-tri destiné à des produits
            tels que des textiles d'habillement, du linge de maison et/ou des chaussures.
        </p>

        <form class="qf-mr-auto qf-flex qf-h-full qf-max-w-full qf-flex-col qf-gap-2w qf-w-full">
            {# Catégorie Section #}
            <div>
                <h2 class="qf-text-xl qf-font-bold qf-mb-3v">Choisissez une catégorie de produit</h2>
                {% dsfr_form_field form.categorie %}
            </div>

            {# Consigne Section #}
            <div data-infotri-target="consigneSection" class="{% if not initial_categorie %}qf-hidden{% endif %}">
                <h2 class="qf-text-xl qf-font-bold qf-mb-3v">Choisissez la consigne</h2>
                {% dsfr_form_field form.consigne %}
            </div>

            {# Phrase Toggle Section #}
            <div data-infotri-target="phraseSection" class="{% if not initial_consigne %}qf-hidden{% endif %}">
                {% dsfr_form_field form.avec_phrase %}
            </div>

            {# Generate Button #}
            <div data-infotri-target="generateButton" class="{% if not initial_consigne %}qf-hidden{% endif %}">
                <button
                    type="button"
                    class="fr-btn"
                    data-action="click->infotri#generate"
                >
                    Générer le code
                </button>
            </div>

            {# Code Section - Back in main #}
            <div data-infotri-target="codeSection" class="qf-hidden">
                <h2 class="qf-text-xl qf-font-bold qf-mb-1w">Code à implémenter</h2>

                <div class="qf-mb-1w">
                    <p class="qf-text-base">
                        Cette balise HTML vous permet d'afficher l'Info-tri générée sur une page de votre site
                        internet. Celle-ci sera automatiquement mise à jour avec les dernières nouveautés.
                    </p>
                    <p class="qf-text-base">
                        Pour l'utiliser, il vous suffit de copier/coller le code ci-dessous dans votre site
                        Internet. En cas de difficultés ou de besoin d'assistance, vous pouvez contacter notre
                        équipe.
                    </p>
                </div>

                <div class="fr-callout">
                    <pre
                        class="qf-whitespace-normal qf-break-all qf-mb-1w qf-p-1w qf-bg-gray-100 qf-rounded qf-text-sm qf-font-mono"
                        data-infotri-target="iframe"
                    ></pre>
                    <button
                        type="button"
                        class="fr-btn"
                        data-infotri-target="copyButton"
                        data-action="click->infotri#copyToClipboard"
                    >
                        Copier
                    </button>
                </div>
            </div>
        </form>
    </main>

    <aside class="qf-flex qf-flex-col qf-overflow-auto">
        <div class="qf-flex qf-items-center qf-justify-center qf-h-full qf-p-4w">
            <div class="qf-bg-white qf-shadow-lg qf-p-3w">
                <turbo-frame id="infotri-preview" src="/infotri/preview?categorie={{ initial_categorie }}&consigne={{ initial_consigne }}&avec_phrase={{ initial_avec_phrase|yesno:'true,false' }}">
                    <div class="qf-flex qf-items-center qf-justify-center qf-min-h-[400px]">
                        <p class="qf-text-gray-500">Chargement de l'aperçu...</p>
                    </div>
                </turbo-frame>
            </div>
        </div>
    </aside>
</div>
{% endblock content %}
