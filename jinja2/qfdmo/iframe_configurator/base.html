{% extends "layout/base.html" %}

{% block content %}
    <div class="fr-container fr-my-3w">
        <h1>Configurateur d'Iframe</h1>

        <form action="{{ url('qfdmo:iframe_configurator') }}" method="post">
            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
            {{ form }}
            <div class="fr-input-group fr-my-4w">
            <button type="submit" class="fr-btn" title="Valider">
                Prévisualiser
            </button>
            </div>
        </form>

        {% if form.cleaned_data %}
        {% with data=form.cleaned_data %}
            <hr>
            <h2>Résultats</h2>
            <h3>Code à implémenter</h3>
            <p>Il vous suffit de copier/coller ce code dans votre site Internet. En cas de difficultés, de questions, ou pour tout autre échange, vous pouvez contacter l’équipe.</p>

            <script
                src='http://localhost:8000/static/carte.js'
                data-action_displayed={{ data.available_actions.as_actions_codes(concat=True) }}
                data-epci_codes="{{ data.epci_codes }}"
                data-limit="{{ data.limit }}"
            >
            </script>
        {% endwith %}
        {% endif %}
    </div>
{% endblock content %}
