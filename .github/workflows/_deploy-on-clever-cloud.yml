name: "Deploy on Clever Cloud"

on:
  workflow_call:
    inputs:
      environment:
        required: true
        type: string
      app_name_key:
        required: true
        type: string

jobs:
  deploy-on-clever-cloud:
    name: Deploy on Clever Cloud
    runs-on: "ubuntu-latest"
    environment: ${{ inputs.environment }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - uses: 47ng/actions-clever-cloud@v2.0.0
        with:
          alias: ${{ vars[inputs.app_name_key] }}
          force: true
        env:
          CLEVER_TOKEN: ${{ secrets.CLEVER_TOKEN }}
          CLEVER_SECRET: ${{ secrets.CLEVER_SECRET }}
